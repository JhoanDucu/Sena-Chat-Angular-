<div class="Botones">
    <ul class="nav nav-tabs" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="grupos-tab" data-bs-toggle="tab" data-bs-target="#grupos" type="button"
                role="tab" aria-controls="grupos" aria-selected="false" [disabled]="enBusqueda"
                (click)="showTab('grupos')">
                <i class="bx bxs-group"></i>
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="privados-tab" data-bs-toggle="tab" data-bs-target="#privados" type="button"
                role="tab" aria-controls="privados" aria-selected="false" [disabled]="enBusqueda"
                (click)="showTab('privados')">
                <i class="bx bxs-user"></i>
            </button>
        </li>
        @if (Sesion.get('rol') == '1') {
        <li class="nav-item" role="presentation">
            <button class="nav-link" type="button" (click)="abrir()" [disabled]="enBusqueda">
                <i class='bx bxs-message-square-dots'></i>
            </button>
        </li>
        }
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="ajustes-tab" data-bs-toggle="tab" data-bs-target="#ajustes" type="button"
                role="tab" aria-controls="ajustes" aria-selected="false" [disabled]="enBusqueda"
                (click)="showTab('ajustes')">
                <i class="bx bxs-cog"></i>
            </button>
        </li>

        <li class="nav-item" role="presentation">
            <button class="nav-link" id="dontk-tab" data-bs-toggle="tab" data-bs-target="#salir" type="button"
                role="tab" aria-controls="contact" aria-selected="false" [disabled]="enBusqueda">
                <i class='bx bxs-conversation'></i>
            </button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button"
                role="tab" aria-controls="contact" aria-selected="false" [disabled]="enBusqueda">
                <i class="bx bxs-help-circle"></i>
            </button>
        </li>
        <div id="foto-perfil">
            <button class="nav-link" id="perfil-tab" data-bs-toggle="tab" data-bs-target="#perfil" type="button"
                role="tab" aria-controls="perfil" aria-selected="false" [disabled]="enBusqueda"
                (click)="showTab('perfil')">
                <img src="../../../assets/img/Usuario3.jpg" alt="">
            </button>
        </div>
    </ul>
</div>

<app-buscador [buscando]="enBusqueda" [itemsDeBusqueda]="{Grupos: grupos, Privados: privados}"
    (buscar)="mostrarBusqueda($event)" (seleccion)="seleccionarEnGrupos($event[0], $event[1], $event[2])">
</app-buscador>

@if (!enBusqueda) {
<div class="tab-content" id="myTabContent">
    <div [className]="tabs.grupos.class" id="grupos" role="tabpanel" aria-labelledby="grupos">
        <div class="grupos" id="grupos" role="tablist">
            <div class="list-group" id="list-tab" role="tablist">
                <span>Grupos</span>
                @for ( g of grupos; track g.id_grupos) {
                <app-grupo (click)="seleccionarEnGrupos(g.id_grupos, $index, 'grupos')"
                    [active]="selected.grupo == g.id_grupos ? true : false" [grupo]="g"
                    [tiempo]="tiene(g, 'fecha_hora')" [reciente]="tiene(g, 'contenido_mensaje')"
                    (moverGrupo)="cambiarPosicion($index, g, 1)">
                </app-grupo>
                }
                @for ( g of grupos; track g.id_grupos) {
                <app-grupo (click)="seleccionarEnGrupos(g.id_grupos, $index, 'grupos')"
                    [active]="selected.grupo == g.id_grupos ? true : false" [grupo]="g"
                    [tiempo]="tiene(g, 'fecha_hora')" [reciente]="tiene(g, 'contenido_mensaje')"
                    (moverGrupo)="cambiarPosicion($index, g, 1)">
                </app-grupo>
                }
                @for ( g of grupos; track g.id_grupos) {
                <app-grupo (click)="seleccionarEnGrupos(g.id_grupos, $index, 'grupos')"
                    [active]="selected.grupo == g.id_grupos ? true : false" [grupo]="g"
                    [tiempo]="tiene(g, 'fecha_hora')" [reciente]="tiene(g, 'contenido_mensaje')"
                    (moverGrupo)="cambiarPosicion($index, g, 1)">
                </app-grupo>
                }
            </div>
        </div>
    </div>

    <div [className]="tabs.privados.class" id="privados" role="tabpanel" aria-labelledby="privados">
        <div class="privados" id="privados" role="tablist">
            <div class="list-group" id="list-tab" role="tablist">
                <span>Privados</span>
                @for (p of privados; track p.id_grupos) {
                <app-grupo (click)="seleccionarEnGrupos(p.id_grupos, $index, 'privados')"
                    [active]="selected.grupo == p.id_grupos ? true : false" [grupo]="p"
                    [tiempo]="tiene(p, 'fecha_hora')" [reciente]="tiene(p, 'contenido_mensaje')"
                    (moverGrupo)="cambiarPosicion($index, p, 2)">
                </app-grupo>
                }
            </div>
        </div>
    </div>
    <div [className]="tabs.perfil.class" id="perfil" role="tabpanel" aria-labelledby="perfil">
        <app-mi-perfil></app-mi-perfil>
    </div>
    <!-- INCLUIR AQUI LOS NUEVOS BOTONES :D -->
</div>
<button id="iniciarChat">Nuevo<i class='bx bxs-conversation'></i></button>
<button id="iniciarChat">Cerrar Sesion <i class="bx bxs-door-open"></i></button>
}

<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">
                    Mensajes a varias fichas ðŸ˜Š
                </h5>
                <button type="button" class="btn-close" (click)="cerrar()"></button>
            </div>
            <form (ngSubmit)="emitirEnvios(mensajes.value)" [formGroup]="mensajes">
                <div class="modal-body">
                    <p>Seleccione las fichas a las que se enviara el mensaje:</p>
                    @for (g of grupos; track g.id_grupos) {
                    <ul class="list-group mb-3" id="escoger">
                        <li class="list-group-item">
                            <label for="{{g.id_grupos}}">{{g.nom_grupos}}</label>
                            <input class="form-check-input variasFichas align-middle" id="{{g.id_grupos}}"
                                type="checkbox" value="{{g.id_grupos}}" formControlName="variasFichas"
                                (click)="check($event.target)">
                        </li>
                    </ul>
                    }
                </div>
                <div class="modal-footer container">
                    <div class="row row-cols-1">
                        <!-- @if (this.checked) {
                        <div class="col mb-3">
                            <div class="progress">
                                <div class="progress-bar progress-bar-striped progress-bar-animated w-75"
                                    role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                                    75%</div>
                            </div>
                        </div>
                        } -->
                        <div class="col input-group">
                            <textarea type="text" placeholder="Escribe el mensaje..." [id]="idInput"
                                formControlName="mensajeFichas" (keyup)="inputSize($event)"
                                class="mensajesFichas"></textarea>
                            <label for="mensajeFichas">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bx bxs-send" id="iconoEnviar"></i>
                                </button>
                            </label>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>